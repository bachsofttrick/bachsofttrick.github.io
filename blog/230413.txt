3:I[5505,[],""]
5:I[8694,[],""]
6:I[7951,["951","static/chunks/951-68001eacaacb5ddd.js","308","static/chunks/app/blog/%5Bslug%5D/page-68a8741e3efe855c.js"],""]
4:["slug","230413","d"]
0:["_eD5MGSl6DD1UgUQXPE3m",[[["",{"children":["blog",{"children":[["slug","230413","d"],{"children":["__PAGE__?{\"slug\":\"230413\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","230413","d"],{"children":["__PAGE__",{},[["$L1",["$","section",null,{"children":[["$","h1",null,{"className":"title font-semibold text-2xl tracking-tighter","children":"Upgrading Grandparents' Wifi III: Covering the house in new Wifi"}],["$","div",null,{"className":"flex justify-between items-center mt-2 mb-8 text-sm","children":["$","p",null,{"className":"text-sm text-neutral-600 dark:text-neutral-400","children":"Apr 13, 2023"}]}],["$","article",null,{"className":"prose","children":"$L2"}]]}],null],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/5c2e7a9dbf5cdffa.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","className":"text-black bg-white dark:text-white dark:bg-black __variable_ac79ff __variable_8a4d12","children":["$","body",null,{"className":"antialiased max-w-4xl mx-4 mt-8 lg:mx-auto","children":["$","main",null,{"className":"flex-auto min-w-0 mt-6 flex flex-col px-2 md:px-0","children":[["$","aside",null,{"className":"-ml-[8px] mb-16 tracking-tight","children":["$","div",null,{"className":"lg:sticky lg:top-20","children":["$","nav",null,{"className":"flex flex-row items-start relative px-0 pb-0 fade md:overflow-auto scroll-pr-6 md:relative","id":"nav","children":["$","div",null,{"className":"flex flex-row space-x-0 pr-10","children":[["$","$L6","/",{"href":"/","className":"transition-all hover:text-neutral-800 dark:hover:text-neutral-200 flex align-middle relative py-1 px-2 m-1","children":"home"}],["$","$L6","/about",{"href":"/about","className":"transition-all hover:text-neutral-800 dark:hover:text-neutral-200 flex align-middle relative py-1 px-2 m-1","children":"about"}],["$","$L6","/blog",{"href":"/blog","className":"transition-all hover:text-neutral-800 dark:hover:text-neutral-200 flex align-middle relative py-1 px-2 m-1","children":"blog"}]]}]}]}]}],["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","section",null,{"children":[["$","h1",null,{"className":"mb-8 text-2xl font-semibold tracking-tighter","children":"404 - Page Not Found"}],["$","p",null,{"className":"mb-4","children":"The page you are looking for does not exist."}]]}],"notFoundStyles":[]}],["$","footer",null,{"className":"mb-16","children":[["$","ul",null,{"className":"font-sm mt-8 flex flex-col space-x-0 space-y-2 text-neutral-600 md:flex-row md:space-x-4 md:space-y-0 dark:text-neutral-300","children":[["$","li",null,{"children":["$undefined",["$","p",null,{"className":" h-7 flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","children":"Corvallis, Oregon, USA"}]]}],["$","li",null,{"children":["$undefined",["$","p",null,{"className":" h-7 flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","children":"Phone: 541-360-9231"}]]}]]}],["$","ul",null,{"className":"font-sm flex flex-col space-x-0 space-y-2 text-neutral-600 md:flex-row md:space-x-4 md:space-y-0 dark:text-neutral-300","children":[["$","li",null,{"children":["$","a",null,{"className":"flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","rel":"noopener noreferrer","target":"_blank","href":"https://github.com/bachsofttrick","children":[["$","svg",null,{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg","children":["$","path",null,{"d":"M2.07102 11.3494L0.963068 10.2415L9.2017 1.98864H2.83807L2.85227 0.454545H11.8438V9.46023H10.2955L10.3097 3.09659L2.07102 11.3494Z","fill":"currentColor"}]}],["$","p",null,{"className":"ml-2 h-7","children":"github"}]]}]}],["$","li",null,{"children":["$","a",null,{"className":"flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","rel":"noopener noreferrer","target":"_blank","href":"https://github.com/bachsofttrick/bachsofttrick.github.io","children":[["$","svg",null,{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg","children":["$","path",null,{"d":"M2.07102 11.3494L0.963068 10.2415L9.2017 1.98864H2.83807L2.85227 0.454545H11.8438V9.46023H10.2955L10.3097 3.09659L2.07102 11.3494Z","fill":"currentColor"}]}],["$","p",null,{"className":"ml-2 h-7","children":"view source"}]]}]}],["$","li",null,{"children":["$","a",null,{"className":"flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","rel":"noopener noreferrer","target":"_blank","href":"https://linkedin.com/in/brian-phan-58530b1b0/","children":[["$","svg",null,{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg","children":["$","path",null,{"d":"M2.07102 11.3494L0.963068 10.2415L9.2017 1.98864H2.83807L2.85227 0.454545H11.8438V9.46023H10.2955L10.3097 3.09659L2.07102 11.3494Z","fill":"currentColor"}]}],["$","p",null,{"className":"ml-2 h-7","children":"linkedin"}]]}]}],["$","li",null,{"children":["$","a",null,{"className":"flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","rel":"noopener noreferrer","target":"_blank","href":"mailto:xuanbach1307@gmail.com","children":[["$","svg",null,{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg","children":["$","path",null,{"d":"M2.07102 11.3494L0.963068 10.2415L9.2017 1.98864H2.83807L2.85227 0.454545H11.8438V9.46023H10.2955L10.3097 3.09659L2.07102 11.3494Z","fill":"currentColor"}]}],["$","p",null,{"className":"ml-2 h-7","children":"email"}]]}]}]]}],["$","p",null,{"className":"mt-8 text-neutral-600 dark:text-neutral-300","children":2024}]]}]]}]}]}]],null],null],[null,"$L7"]]]]
2:[["$","p",null,{"children":"So. Here we are. The third part of the long-running series where I try\nto improve my Internet condition. So no point beating around the bushes.\nI plan to transform my 4G connection into Wifi using whatever was\navailable to me, because I'm a cheapskate that refuse to spend money,\nbut had no problem spending it on a thermometer, then broke it by\nputting it in a freezer. I also enjoy learning how networking works, as\nI always thought that a router is like a magic box. It was when I got an\nAsus router, turned on ssh that I discovered routers are all Linux\nboxes."}],"\n",["$","h4",null,{"id":"prerequisites","className":"$undefined","children":[[["$","a","link-prerequisites",{"href":"#prerequisites","className":"anchor"}]],"Prerequisites"]}],"\n",["$","p",null,{"children":"To prepare for this job, I dug up my old Raspberry Pi 3. I haven't had\nmuch use for it since my HP laptop took over the server work from the\nboard. It has 4 USB port and a LAN port. My plan was to turn this board\ninto a router. Just a router, not one of those combo things that you\ncommonly find. The LAN port would be connected to a Wifi access point\n(AP). For the USB port, I plugged a 4G USB Modem with a SIM card placed\nin."}],"\n",["$","p",null,{"children":"The TP-Link Archer C50 router currrently in use would be turned into AP\nin place of a router. The reason was that the Raspberry Pi has a weak\nWifi chip, it couldn't transmit very far, not like a dedicated device\nwould. Moreover, I didn't need its routing function."}],"\n",["$","p",null,{"children":"The 4G USB Modem would be a Sony Xperia Z. I borrowed it for this job\nbecause it wasn't in use and it could install a custom ROM or OS, free\nfrom restrictions of the original ROM. I used Lineage OS 16, which was\nAndroid 9 for the phone. Android 9 and later allows you to set your\nphone to USB tethering mode as default anytime it is connected via USB."}],"\n",["$","p",null,{"children":"A 4GB or higher micro SD card was needed to install a router OS of your\nchoice. In this case, OpenWrt."}],"\n",["$","p",null,{"children":"Location. You need to get as close as possible to a cell tower from your\nhouse. This would require you to use a phone with the SIM card you want\nto use as the source to find a cell tower that belongs to the SIM\nnetwork. You can check signal strength by going to Settings -> About\nphone -> SIM Status or something similar. Keep an eye on the negative\nnumber and dBm. The higher the number (lower number in negative) the\nbetter the signal. You can also use speedtest.net or fast.com to make a\nquick speed test."}],"\n",["$","h4",null,{"id":"preparing-the-router","className":"$undefined","children":[[["$","a","link-preparing-the-router",{"href":"#preparing-the-router","className":"anchor"}]],"Preparing the router"]}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/OpenWrt_Logo.svg",{"src":"/images/blog/230413/pi_router/OpenWrt_Logo.svg"}]]}]}],"\n",["$","p",null,{"children":"The reason I chose OpenWrt for my router OS is that, while it's\nintriguing to DIY by using Raspbian and set everything up using iptables\nfor NAT, ufw for firewall, dnsmasq for DNS, DHCP, it's a lot of work to\nset it up separately. Instead, OpenWrt offers a web UI (luci) to help\nyou set everything up quickly. I also wanted to try it out on a real\nscenario, as before this I ran it on my virtual machine to get a feel of\nthe OS."}],"\n",["$","p",null,{"children":"Go to the download page of OpenWrt, get the latest version, with target\nas bcm27xx -> bcm2710 (Raspberry Pi 3 SoC). They offer 2 choice,\next4-factory or squashfs-factory. I chose ext4 due to ease of use, as I\ncan use GParted to expand the data partition to full. squashfs takes\nmore steps, and has to be done in terminal. I might try out squashfs\nversion later, because that's the version normally used in modified\nrouters. After downloading the gzip file, extract it to get the image\n(img) file. Use either balenaEtcher or dd command to flash it to the SD\ncard (sda in this example):"}],"\n",["$","p",null,{"children":["$","em",null,{"children":"dd if=openwrt.img of=/dev/sda bs=1M"}]}],"\n",["$","p",null,{"children":["After that, put the card in the Pi, plug in the power and boot it\nup.Connect to your Pi using LAN and open the browser, type in\n",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"http://192.168.1.1/","children":"http://192.168.1.1/"}]," (default IP of the LAN interface) with username\nroot, no password to enter OpenWrt management."]}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/1.jpg",{"src":"/images/blog/230413/pi_router/1.jpg"}]]}]}],"\n",["$","p",null,{"children":"First, we need to install some additional packages. Go to Network ->\nWireless. Press Scan on a wireless interface to connect to an access\npoint."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/8.jpg",{"src":"/images/blog/230413/pi_router/8.jpg"}]]}]}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/9.jpg",{"src":"/images/blog/230413/pi_router/9.jpg"}]]}]}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/10.jpg",{"src":"/images/blog/230413/pi_router/10.jpg"}]]}]}],"\n",["$","p",null,{"children":"Type in password of that Wifi AP and submit. On the next page, you can\njust press Save, as that page only matters when you create an AP from\nthis board. Press Save & Apply. Now go to Network -> Interfaces. You\nshould see another interface added in."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/11.jpg",{"src":"/images/blog/230413/pi_router/11.jpg"}]]}]}],"\n",["$","p",null,{"children":"Now go to System -> Software and update lists. You have to do this at\nevery restart when you want to install new packages."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/7.jpg",{"src":"/images/blog/230413/pi_router/7.jpg"}]]}]}],"\n",["$","p",null,{"children":"You need to install these packages to use the 4G USB Modem, in this case\nan Android phone."}],"\n",["$","h4",null,{"id":"preparing-the-access-point","className":"$undefined","children":[[["$","a","link-preparing-the-access-point",{"href":"#preparing-the-access-point","className":"anchor"}]],"Preparing the access point"]}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/config_ac50_dhcp.jpg",{"src":"/images/blog/230413/config_ac50_dhcp.jpg"}]]}]}],"\n",["$","p",null,{"children":"There are 2 ways around this. Either set this router into Access Point\nmode, or you can turn off DHCP Server, which is a function that hands\nout IP address to devices connecting to it. I chose the latter, because\nI never had much luck with the former. Every time I try putting a router\ninto AP mode, I end up resetting it at the end due to not being able to\naccess its configuration page. But you do you."}],"\n",["$","p",null,{"children":"After that, use an Ethernet cable, connect Raspberry Pi to any LAN port\non the TP-Link router, or either LAN / WAN if you choose AP mode."}],"\n",["$","h4",null,{"id":"finding-place-to-put-the-combo-device","className":"$undefined","children":[[["$","a","link-finding-place-to-put-the-combo-device",{"href":"#finding-place-to-put-the-combo-device","className":"anchor"}]],"Finding place to put the \"combo\" device"]}],"\n",["$","p",null,{"children":"As I previously mentioned, location is important when it comes to 4G\nconnection. In my case, the house is situated near a cell tower, right\noutside the kitchen's window."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/anten.jpg",{"src":"/images/blog/230413/anten.jpg"}]]}]}],"\n",["$","p",null,{"children":"So the obvious answer is to place the router, the access point, the\nmodem in the kitchen, right? Well, yeah. I put the combo in a chair at\nfirst, and also tried to elevate the phone using the Pi as leverage.\nThat way the phone could get the best signal. It was a sight to behold."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/combo.jpg",{"src":"/images/blog/230413/combo.jpg"}]]}]}],"\n",["$","p",null,{"children":"2 weeks after that, I got a dock to prop the phone up properly so it\nlooked more professional and moved the combo to the top of the fridge,\ncloser to the cell tower. By placing it there, I got -89 dBm, as opposed\nto -95 dBm on the chair. It was not much, because this was an old phone,\nbut good enough to work."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/phone_fridge.jpg",{"src":"/images/blog/230413/phone_fridge.jpg"}]]}]}],"\n",["$","h4",null,{"id":"getting-the-router-to-connect-to-the-internet","className":"$undefined","children":[[["$","a","link-getting-the-router-to-connect-to-the-internet",{"href":"#getting-the-router-to-connect-to-the-internet","className":"anchor"}]],"Getting the router to connect to the Internet"]}],"\n",["$","p",null,{"children":"Plugging the phone to the Raspberry Pi, I had to register the phone as a\nnetwork interface on OpenWrt. Go to Network -> Interfaces. Click Add\nNew Interface. Name the interface. Choose DHCP client as protocol,\nbecause you will get IP address from the USB-tethered phone. In device,\nchoose usb0 and click Create Interface. On the next screen, pick\nFirewall Settings, assign the interface to wan zone then Save. After\nthat, click Save & Apply. So instead of cable Internet, I connected to\nthe Internet via 4G network."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/3.jpg",{"src":"/images/blog/230413/pi_router/3.jpg"}]]}]}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/5.jpg",{"src":"/images/blog/230413/pi_router/5.jpg"}]]}]}],"\n",["$","p",null,{"children":"If you prefer to use your custom DNS, go to 4G interface, Advanced\nSettings, uncheck Use DNS servers advertised by peer. Then go to Network\n-> DHCP and DNS. Fill in your desired DNS in DNS forwardings (remember\nto press plus) then Save & Apply."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/pi_router/12.jpg",{"src":"/images/blog/230413/pi_router/12.jpg"}]]}]}],"\n",["$","h4",null,{"id":"result","className":"$undefined","children":[[["$","a","link-result",{"href":"#result","className":"anchor"}]],"Result"]}],"\n",["$","p",null,{"children":"So far so good. It worked like a dream. The Internet was a lot better.\nAnd thanks to the Raspberry Pi having a better CPU than most routers, it\ncould withstand more clients connecting to the network and route better.\nOn early morning or late night, I could get up to 80 Mbps download.\nSpeed is inconsistent throughout the day, ranging from 15 to 50 Mbps.\nBut overall, it's more stable than the cable Internet."}],"\n",["$","h4",null,{"id":"improvements","className":"$undefined","children":[[["$","a","link-improvements",{"href":"#improvements","className":"anchor"}]],"Improvements"]}],"\n",["$","p",null,{"children":"About 3 weeks into the project, I swapped the phone for a 4G USB Modem,\nbecause doing this heated up the phone considerably and had a negative\nimpact to its battery. It's a cheap no-name one because I wasn't gonna\nfully commit to this project. It also improved signal strength, getting\nit up to -76 dBm."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/IMG_20230410_103017_860.jpg",{"src":"/images/blog/230413/IMG_20230410_103017_860.jpg"}]]}]}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/4g_router/4g_1.2.jpg",{"src":"/images/blog/230413/4g_router/4g_1.2.jpg"}]]}]}],"\n",["$","p",null,{"children":"I also slowly phased out the TP-Link + Pi combo in favor of a Xiaomi Mi\nWiFi R3G v1. It's a router with MT7621 SoC with dual-core 880 MHz MIPS\nprocessor, 256 MB RAM, 128MB ROM. Compared to Raspberry Pi, it's like\nDavid vs Goliath. But it does feature hardware routing capability, so\nthat's neat. It runs OpenWrt with 4G USB Modem support, so I could plug\nthe USB Modem in and be done with it. Same performance with 1 less\ndevice to worry about."}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":[["$","img","/images/blog/230413/IMG_20230411_083037_638.jpg",{"src":"/images/blog/230413/IMG_20230411_083037_638.jpg"}]]}]}],"\n",["$","p",null,{"children":"References:"}],"\n",["$","p",null,{"children":["- ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://downloads.openwrt.org/","children":"OpenWrt Downloads"}]]}],"\n",["$","p",null,{"children":["- ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.balena.io/etcher","children":"balenaEtcher"}]]}],"\n",["$","p",null,{"children":["- ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://forum.xda-developers.com/t/rom-final-9-0-lineageos-16-0-for-xperia-z.3924175/","children":"LineageOS 16.0 for Xperia\nZ"}]]}],"\n",["$","p",null,{"children":["- ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://www.raspberrypi.com/products/raspberry-pi-3-model-b-plus/","children":"Raspberry Pi 3 Model\nB+"}]]}],"\n",["$","p",null,{"children":["- ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://openwrt.org/toh/xiaomi/mir3g","children":"Xiaomi Mi WiFi R3G"}]]}]]
7:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Upgrading Grandparents' Wifi III: Covering the house in new Wifi | Brian Phan"}],["$","meta","3",{"name":"description","content":"This is my portfolio."}],["$","meta","4",{"name":"robots","content":"index, follow"}],["$","meta","5",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","meta","6",{"property":"og:title","content":"My Portfolio"}],["$","meta","7",{"property":"og:description","content":"This is my portfolio."}],["$","meta","8",{"property":"og:url","content":"https://bachsofttrick.github.io"}],["$","meta","9",{"property":"og:site_name","content":"My Portfolio"}],["$","meta","10",{"property":"og:locale","content":"en_US"}],["$","meta","11",{"property":"og:type","content":"website"}],["$","meta","12",{"name":"twitter:card","content":"summary"}],["$","meta","13",{"name":"twitter:title","content":"My Portfolio"}],["$","meta","14",{"name":"twitter:description","content":"This is my portfolio."}],["$","meta","15",{"name":"next-size-adjust"}]]
1:null
