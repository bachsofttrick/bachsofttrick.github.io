3:I[5505,[],""]
5:I[8694,[],""]
6:I[7951,["951","static/chunks/951-68001eacaacb5ddd.js","308","static/chunks/app/blog/%5Bslug%5D/page-cd9c4eaa86cf1edf.js"],""]
4:["slug","241019","d"]
0:["SYwwcJNECYT7HMlMo69HY",[[["",{"children":["blog",{"children":[["slug","241019","d"],{"children":["__PAGE__?{\"slug\":\"241019\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","241019","d"],{"children":["__PAGE__",{},[["$L1",["$","section",null,{"children":[["$","h1",null,{"className":"title font-semibold text-2xl tracking-tighter","children":"Virtualization on my server without reinstalling OS"}],["$","div",null,{"className":"flex justify-between items-center mt-2 mb-8 text-sm","children":["$","p",null,{"className":"text-sm text-neutral-600 dark:text-neutral-400","children":"Oct 19, 2024"}]}],["$","article",null,{"className":"prose","children":"$L2"}]]}],[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/f748654d5fd56294.css","precedence":"next","crossOrigin":"$undefined"}]]],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/5f4b86ec0fe97e1b.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","className":"text-black bg-white dark:text-white dark:bg-black __variable_ac79ff __variable_8a4d12","children":["$","body",null,{"className":"antialiased max-w-4xl mx-4 mt-8 lg:mx-auto","children":["$","main",null,{"className":"flex-auto min-w-0 mt-6 flex flex-col px-2 md:px-0","children":[["$","aside",null,{"className":"-ml-[8px] mb-16 tracking-tight","children":["$","div",null,{"className":"lg:sticky lg:top-20","children":["$","nav",null,{"className":"flex flex-row items-start relative px-0 pb-0 fade md:overflow-auto scroll-pr-6 md:relative","id":"nav","children":["$","div",null,{"className":"flex flex-row space-x-0 pr-10","children":[["$","$L6","/",{"href":"/","className":"transition-all hover:text-neutral-800 dark:hover:text-neutral-200 flex align-middle relative py-1 px-2 m-1","children":"home"}],["$","$L6","/about",{"href":"/about","className":"transition-all hover:text-neutral-800 dark:hover:text-neutral-200 flex align-middle relative py-1 px-2 m-1","children":"about"}],["$","$L6","/about-projects",{"href":"/about-projects","className":"transition-all hover:text-neutral-800 dark:hover:text-neutral-200 flex align-middle relative py-1 px-2 m-1","children":"project"}],["$","$L6","/blog",{"href":"/blog","className":"transition-all hover:text-neutral-800 dark:hover:text-neutral-200 flex align-middle relative py-1 px-2 m-1","children":"blog"}]]}]}]}]}],["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","section",null,{"children":[["$","h1",null,{"className":"mb-8 text-2xl font-semibold tracking-tighter","children":"404 - Page Not Found"}],["$","p",null,{"className":"mb-4","children":"The page you are looking for does not exist."}]]}],"notFoundStyles":[]}],["$","footer",null,{"className":"mb-16","children":[["$","ul",null,{"className":"font-sm mt-8 flex flex-col space-x-0 space-y-2 text-neutral-600 md:flex-row md:space-x-4 md:space-y-0 dark:text-neutral-300","children":[["$","li",null,{"children":["$undefined",["$","p",null,{"className":" h-7 flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","children":"Corvallis, Oregon, USA"}]]}],["$","li",null,{"children":["$undefined",["$","p",null,{"className":" h-7 flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","children":"Phone: 541-360-9231"}]]}]]}],["$","ul",null,{"className":"font-sm flex flex-col space-x-0 space-y-2 text-neutral-600 md:flex-row md:space-x-4 md:space-y-0 dark:text-neutral-300","children":[["$","li",null,{"children":["$","a",null,{"className":"flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","rel":"noopener noreferrer","target":"_blank","href":"https://github.com/bachsofttrick/","children":[["$","svg",null,{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg","children":["$","path",null,{"d":"M2.07102 11.3494L0.963068 10.2415L9.2017 1.98864H2.83807L2.85227 0.454545H11.8438V9.46023H10.2955L10.3097 3.09659L2.07102 11.3494Z","fill":"currentColor"}]}],["$","p",null,{"className":"ml-2 h-7","children":"github"}]]}]}],["$","li",null,{"children":["$","a",null,{"className":"flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","rel":"noopener noreferrer","target":"_blank","href":"https://www.linkedin.com/in/brphan/","children":[["$","svg",null,{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg","children":["$","path",null,{"d":"M2.07102 11.3494L0.963068 10.2415L9.2017 1.98864H2.83807L2.85227 0.454545H11.8438V9.46023H10.2955L10.3097 3.09659L2.07102 11.3494Z","fill":"currentColor"}]}],["$","p",null,{"className":"ml-2 h-7","children":"linkedin"}]]}]}],["$","li",null,{"children":["$","a",null,{"className":"flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","rel":"noopener noreferrer","target":"_blank","href":"mailto:xuanbach1307@gmail.com","children":[["$","svg",null,{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg","children":["$","path",null,{"d":"M2.07102 11.3494L0.963068 10.2415L9.2017 1.98864H2.83807L2.85227 0.454545H11.8438V9.46023H10.2955L10.3097 3.09659L2.07102 11.3494Z","fill":"currentColor"}]}],["$","p",null,{"className":"ml-2 h-7","children":"email"}]]}]}],["$","li",null,{"children":["$","a",null,{"className":"flex items-center transition-all hover:text-neutral-800 dark:hover:text-neutral-100","rel":"noopener noreferrer","target":"_blank","href":"https://github.com/bachsofttrick/bachsofttrick.github.io/","children":[["$","svg",null,{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg","children":["$","path",null,{"d":"M2.07102 11.3494L0.963068 10.2415L9.2017 1.98864H2.83807L2.85227 0.454545H11.8438V9.46023H10.2955L10.3097 3.09659L2.07102 11.3494Z","fill":"currentColor"}]}],["$","p",null,{"className":"ml-2 h-7","children":"view source"}]]}]}]]}],["$","p",null,{"className":"mt-8 text-neutral-600 dark:text-neutral-300","children":2025}]]}]]}]}]}]],null],null],[null,"$L7"]]]]
8:T61f,<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">sudo</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">adduser</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">`</span><span class="sh__token--string" style="color: var(--sh-string)">id -un</span><span class="sh__token--string" style="color: var(--sh-string)">`</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">kvm</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">sudo</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">adduser</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">`</span><span class="sh__token--string" style="color: var(--sh-string)">id -un</span><span class="sh__token--string" style="color: var(--sh-string)">`</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">libvirt</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>2:[["$","p",null,{"children":["I always want to have a virtualization lab in my home. But I don't want my server to fully commit to that idea.\nEven though Proxmox seems like a decent OS for the job, I still pick Debian for more customization. It's more\ngeneral-purpose compared to dedicated OS. There's only one package that can help me realize the dream, ",["$","em",null,{"children":"Cockpit"}],"."]}],"\n",["$","p",null,{"children":[["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://cockpit-project.org/","children":"Cockpit"}]," is a web interface for managing a server. It comes with many plugins that can be\ninstalled separately. I planned to use this for managing virtual machines, because this is the only application\nwith a UI to do so."]}],"\n",["$","h4",null,{"id":"installing","className":"$undefined","children":[[["$","a","link-installing",{"href":"#installing","className":"anchor"}]],"Installing"]}],"\n",["$","p",null,{"children":"Quite easy if you're on Debian or Ubuntu. Just type"}],"\n",["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\">sudo</span><span class=\"sh__token--space\" style=\"color: var(--sh-space)\"> </span><span class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\">apt</span><span class=\"sh__token--space\" style=\"color: var(--sh-space)\"> </span><span class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\">install</span><span class=\"sh__token--space\" style=\"color: var(--sh-space)\"> </span><span class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\">cockpit</span><span class=\"sh__token--space\" style=\"color: var(--sh-space)\"> </span><span class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\">cockpit</span><span class=\"sh__token--sign\" style=\"color: var(--sh-sign)\">-</span><span class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\">machines</span><span class=\"sh__token--break\" style=\"color: var(--sh-break)\"></span></span>"}}]}],"\n",["$","p",null,{"children":["It will automatically install ",["$","em",null,{"children":"Cockpit"}]," along with VM plugin and other dependencies."]}],"\n",["$","h4",null,{"id":"quick-look","className":"$undefined","children":[[["$","a","link-quick-look",{"href":"#quick-look","className":"anchor"}]],"Quick look"]}],"\n",["$","p",null,{"children":["Access the Cockpit UI through address ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://your.ip:9090/","children":"https://your.ip:9090/"}],". Your username and password\nis your current account."]}],"\n",["$","p",null,{"children":[["$","p",null,{"className":"flex justify-center","children":["$","img",null,{"src":"/images/blog/241019/1.jpg","alt":""}]}],"\n",["$","p",null,{"className":"flex justify-center","children":["$","img",null,{"src":"/images/blog/241019/2.jpg","alt":""}]}]]}],"\n",["$","p",null,{"children":["When you first log in, the account will be assigned ",["$","em",null,{"children":"Limited access"}],", meaning it does not have ",["$","em",null,{"children":"sudo"}]," access.\nYou need to ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://cockpit-project.org/guide/latest/privileges.html","children":"escalate"}]," to ",["$","em",null,{"children":"Administrative access"}],"\nif you want more functionalities."]}],"\n",["$","h4",null,{"id":"creating-virtual-machines","className":"$undefined","children":[[["$","a","link-creating-virtual-machines",{"href":"#creating-virtual-machines","className":"anchor"}]],"Creating virtual machines"]}],"\n",["$","p",null,{"children":["Now, this is the hard part. I tried getting it work in the past and didn't end well. With a new server, I intended to\ndo it again. Maybe this time it would work.",["$","br",null,{}],"\n","Anyway, this is not a comprehensive guide, I got it working but I will try to retrace my steps and record them for\nfuture references."]}],"\n",["$","p",null,{"children":[["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://help.ubuntu.com/community/KVM/Installation","children":"These parts are referenced from this article."}],["$","br",null,{}],"\n","First, run this command to make sure VT-x (Intel) or AMD-V (AMD) is enabled in BIOS."]}],"\n",["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"sh__line\"><span class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\">kvm</span><span class=\"sh__token--sign\" style=\"color: var(--sh-sign)\">-</span><span class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\">ok</span><span class=\"sh__token--break\" style=\"color: var(--sh-break)\"></span></span>"}}]}],"\n",["$","p",null,{"children":["If it says ",["$","strong",null,{"children":"INFO: /dev/kvm exists"}]," then you can proceed.",["$","br",null,{}],"\n","Second, add your own user into group ",["$","em",null,{"children":"kvm"}]," and ",["$","em",null,{"children":"libvirt"}],"."]}],"\n",["$","pre",null,{"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$8"}}]}],"\n",["$","p",null,{"children":["Next, I need to set up a storage pool. In Cockpit, a storage pool makes sense for hard drives, not really for disk\nimages, because they would ask you to show them the ",["$","em",null,{"children":"location"}]," of the ISO file, regardless of it belonging in the pool."]}],"\n",["$","p",null,{"children":[["$","p",null,{"className":"flex justify-center","children":["$","img",null,{"src":"/images/blog/241019/3.jpg","alt":""}]}],"\n",["$","p",null,{"className":"flex justify-center","children":["$","img",null,{"src":"/images/blog/241019/4.jpg","alt":""}]}],"\n",["$","p",null,{"className":"flex justify-center","children":["$","img",null,{"src":"/images/blog/241019/5.jpg","alt":""}]}]]}],"\n",["$","p",null,{"children":"When it asks you what type of connection, there are two types. These also show up when creating a virtual machine (VM).\nThe two types are system and user session:"}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"System"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Ideal for server VMs"}],"\n",["$","li",null,{"children":"VM will launch with root permissions"}],"\n",["$","li",null,{"children":"Ideal networking support"}],"\n",["$","li",null,{"children":"Permissions denied for disk images in home directories"}],"\n"]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"User session"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Good choice for desktop virtualization"}],"\n",["$","li",null,{"children":"VM launched with unprivileged limited access, with the process and PTY owned by your user account"}],"\n",["$","li",null,{"children":"Restrictions in networking (SLIRP-based emulation) and PCI device assignment"}],"\n",["$","li",null,{"children":"Disk images can be stored in user home directory"}],"\n"]}],"\n",["$","p",null,{"children":["When first starting, I created like one type of pool, and another type of VM. So mix and match, which ended up with the\nVM reporting error about permissions on the drive or images. Even if they both the same type (User session), I still\nreceived some errors about permissions as well. So I consulted ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/jedi4ever/veewee/issues/996","children":"this GitHub issue"}],"\nand some solutions worked:"]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Change /etc/libvirt/qemu.conf to make things work. Uncomment user/group to work as root."}],"\n",["$","li",null,{"children":["Copy your ISO images and hard disks to /var/lib/libvirt/images. It only works for ",["$","em",null,{"children":"system"}]," VMs."]}],"\n",["$","li",null,{"children":"Change permission and owner:group of folder you store disks in using chmod and chown, respectively."}],"\n"]}],"\n",["$","p",null,{"children":["I also adjust Spice and VNC listen address to be 0.0.0.0 by default ",["$","em",null,{"children":"in /etc/libvirt/qemu.conf"}],", so I can connect to the VM ",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/cockpit-project/cockpit-machines/issues/73","children":"remotely"}],".",["$","br",null,{}],"\n","One last thing. Make sure the CPU type is ",["$","strong",null,{"children":"host-passthrough"}]," for the best performance. According to\n",["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://wiki.openstack.org/wiki/LibvirtXMLCPUModel","children":"an OpenStack post"}],", there is a difference between\nhost-model and host-passthrough."]}],"\n",["$","p",null,{"children":["$","p",null,{"className":"flex justify-center","children":["$","img",null,{"src":"/images/blog/241019/6.jpg","alt":""}]}]}]]
7:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Virtualization on my server without reinstalling OS | Brian Phan"}],["$","meta","3",{"name":"description","content":"This is my portfolio."}],["$","meta","4",{"name":"robots","content":"index, follow"}],["$","meta","5",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","meta","6",{"property":"og:title","content":"My Portfolio"}],["$","meta","7",{"property":"og:description","content":"This is my portfolio."}],["$","meta","8",{"property":"og:url","content":"https://bachsofttrick.github.io"}],["$","meta","9",{"property":"og:site_name","content":"My Portfolio"}],["$","meta","10",{"property":"og:locale","content":"en_US"}],["$","meta","11",{"property":"og:type","content":"website"}],["$","meta","12",{"name":"twitter:card","content":"summary"}],["$","meta","13",{"name":"twitter:title","content":"My Portfolio"}],["$","meta","14",{"name":"twitter:description","content":"This is my portfolio."}],["$","meta","15",{"name":"next-size-adjust"}]]
1:null
